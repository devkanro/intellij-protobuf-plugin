<idea-plugin>
    <id>io.kanro.idea.plugin.protobuf</id>
    <name>Protobuf</name>
    <vendor>HIGAN</vendor>

    <!-- Product and plugin compatibility requirements -->
    <!-- https://plugins.jetbrains.com/docs/intellij/plugin-compatibility.html -->
    <depends>com.intellij.modules.platform</depends>
    <depends>com.intellij.modules.lang</depends>
    <depends optional="true" config-file="io.kanro.idea.plugin.protobuf-java.xml">com.intellij.modules.java</depends>
    <depends optional="true" config-file="io.kanro.idea.plugin.protobuf-sisyphus.xml">org.jetbrains.kotlin</depends>

    <extensionPoints>
        <extensionPoint
                interface="io.kanro.idea.plugin.protobuf.lang.file.FileResolver"
                dynamic="true"
                name="fileResolver"/>
        <extensionPoint
                interface="io.kanro.idea.plugin.protobuf.lang.psi.primitive.feature.ProtobufSymbolReferenceProvider"
                dynamic="true"
                name="symbolReferenceProvider"/>
        <extensionPoint
                interface="io.kanro.idea.plugin.protobuf.lang.psi.primitive.feature.ProtobufIndexProvider"
                dynamic="true"
                name="indexProvider"/>
        <extensionPoint
                interface="io.kanro.idea.plugin.protobuf.lang.psi.primitive.feature.ProtobufStubExternalProvider"
                dynamic="true"
                name="stubExternalProvider"/>
    </extensionPoints>

    <extensions defaultExtensionNs="io.kanro.idea.plugin.protobuf">
        <fileResolver id="module"
                      implementation="io.kanro.idea.plugin.protobuf.lang.file.ModuleSourceProtobufFileResolver"/>
        <fileResolver id="depModule"
                      implementation="io.kanro.idea.plugin.protobuf.lang.file.DepModuleSourceProtobufFileResolver"/>
        <fileResolver id="library"
                      implementation="io.kanro.idea.plugin.protobuf.lang.file.LibraryProtobufFileResolver"/>
        <fileResolver id="settings"
                      implementation="io.kanro.idea.plugin.protobuf.lang.file.ImportRootsFileResolver"/>
        <symbolReferenceProvider
                implementation="io.kanro.idea.plugin.protobuf.aip.reference.contributor.ProtobufTypeNameInStringProvider"/>
        <stubExternalProvider
                implementation="io.kanro.idea.plugin.protobuf.java.FileJavaOptionsProvider"/>
    </extensions>

    <extensions defaultExtensionNs="com.intellij">
        <fileType name="protobuf" language="protobuf"
                  implementationClass="io.kanro.idea.plugin.protobuf.lang.ProtobufFileType" extensions="proto"/>
        <lang.parserDefinition language="protobuf"
                               implementationClass="io.kanro.idea.plugin.protobuf.lang.ProtobufParserDefinition"/>
        <lang.syntaxHighlighter language="protobuf"
                                implementationClass="io.kanro.idea.plugin.protobuf.lang.highligh.ProtobufHighlighter"/>
        <annotator language="protobuf"
                   implementationClass="io.kanro.idea.plugin.protobuf.lang.highligh.ProtobufHighlightingAnnotator"
                   order="FIRST"/>

        <annotator language="protobuf"
                   implementationClass="io.kanro.idea.plugin.protobuf.lang.annotator.ProtobufAnnotator"/>
        <annotator
                language="protobuf"
                implementationClass="io.kanro.idea.plugin.protobuf.lang.annotator.Protobuf3Annotator"/>
        <annotator
                language="protobuf"
                implementationClass="io.kanro.idea.plugin.protobuf.lang.annotator.Protobuf2Annotator"/>

        <iconProvider implementation="io.kanro.idea.plugin.protobuf.lang.ui.ProtobufIconProvider"/>
        <lang.ast.factory implementationClass="io.kanro.idea.plugin.protobuf.lang.psi.ProtobufASTFactory"
                          language="protobuf"/>
        <lang.documentationProvider language="protobuf"
                                    implementationClass="io.kanro.idea.plugin.protobuf.lang.ui.ProtobufDocumentationProvider"/>
        <lang.quoteHandler language="protobuf"
                           implementationClass="io.kanro.idea.plugin.protobuf.lang.edting.ProtobufQuoteHandler"/>
        <completion.contributor language="protobuf"
                                implementationClass="io.kanro.idea.plugin.protobuf.lang.completion.ProtobufCompletionContributor"/>
        <lang.psiStructureViewFactory language="protobuf"
                                      implementationClass="io.kanro.idea.plugin.protobuf.lang.ui.ProtobufStructureViewFactory"/>
        <elementDescriptionProvider
                implementation="io.kanro.idea.plugin.protobuf.lang.ui.ProtobufElementDescriptionProvider"/>
        <lang.importOptimizer language="protobuf"
                              implementationClass="io.kanro.idea.plugin.protobuf.lang.formatter.ProtobufImportOptimizer"/>
        <lang.commenter language="protobuf"
                        implementationClass="io.kanro.idea.plugin.protobuf.lang.formatter.ProtobufCommenter"/>
        <codeStyleSettingsProvider
                implementation="io.kanro.idea.plugin.protobuf.lang.formatter.ProtobufCodeStyleSettingsProvider"/>
        <langCodeStyleSettingsProvider
                implementation="io.kanro.idea.plugin.protobuf.lang.formatter.ProtobufLanguageCodeStyleSettingsProvider"/>
        <lang.braceMatcher language="protobuf"
                           implementationClass="io.kanro.idea.plugin.protobuf.lang.edting.ProtobufPairedBraceMatcher"/>
        <lang.formatter language="protobuf"
                        implementationClass="io.kanro.idea.plugin.protobuf.lang.formatter.ProtobufFormattingModelBuilder"/>
        <lang.findUsagesProvider language="protobuf"
                                 implementationClass="io.kanro.idea.plugin.protobuf.lang.usage.ProtobufFindUsageProvider"
        />
        <usageTypeProvider implementation="io.kanro.idea.plugin.protobuf.lang.usage.ProtobufUsageTypeProvider"/>
        <stubElementTypeHolder class="io.kanro.idea.plugin.protobuf.lang.psi.ProtobufTypes"/>
        <lang.foldingBuilder language="protobuf"
                             implementationClass="io.kanro.idea.plugin.protobuf.lang.folding.ProtobufFoldingBuilder"/>
        <lang.refactoringSupport language="protobuf"
                                 implementationClass="io.kanro.idea.plugin.protobuf.lang.reference.ProtobufRefactoringSupportProvider"/>
        <spellchecker.support language="protobuf"
                              implementationClass="io.kanro.idea.plugin.protobuf.lang.edting.ProtobufSpellcheckingStrategy"/>

        <projectConfigurable groupId="language"
                             instance="io.kanro.idea.plugin.protobuf.lang.settings.ProtobufSettingsConfigurable"/>
        <projectService serviceImplementation="io.kanro.idea.plugin.protobuf.lang.settings.ProtobufSettings"/>
        <gotoSymbolContributor
                implementation="io.kanro.idea.plugin.protobuf.lang.reference.ProtobufGotoSymbolContributor"/>
        <psi.referenceContributor
                implementation="io.kanro.idea.plugin.protobuf.lang.reference.ProtobufSymbolReferenceContributor"/>

        <!-- Stub -->
        <stubElementTypeHolder class="io.kanro.idea.plugin.protobuf.lang.psi.ProtobufTypes"/>
        <stubIndex implementation="io.kanro.idea.plugin.protobuf.lang.psi.stub.index.ShortNameIndex"/>
        <stubIndex implementation="io.kanro.idea.plugin.protobuf.lang.psi.stub.index.QualifiedNameIndex"/>
        <stubIndex implementation="io.kanro.idea.plugin.protobuf.lang.psi.stub.index.ResourceTypeIndex"/>

        <!-- AIP Spec -->
        <psi.referenceContributor language="protobuf"
                                  implementation="io.kanro.idea.plugin.protobuf.aip.reference.contributor.AipReferenceContributor"/>
        <annotator language="protobuf" implementationClass="io.kanro.idea.plugin.protobuf.aip.annotator.AipAnnotator"/>
        <completion.contributor language="protobuf"
                                implementationClass="io.kanro.idea.plugin.protobuf.aip.completion.AipCompletionContributor"/>
    </extensions>
</idea-plugin>
